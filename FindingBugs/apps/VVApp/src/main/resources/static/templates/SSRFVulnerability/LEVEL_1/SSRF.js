getData();

function setDataInProjectsResponseDiv(data) {
  if (data.isValid) {
    let projectNameAndUrls = JSON.parse(data.content);
    let tableInformation = '<table id="InfoTable">';
    if (projectNameAndUrls.length > 0) {
      for (let key in projectNameAndUrls[0]) {
        tableInformation =
          tableInformation + '<th class="InfoColumn">' + key + "</th>";
      }
    }

    projectNameAndUrls.forEach((projNameAndUrl) => {
      tableInformation =
        tableInformation +
        "<tr><td class='InfoColumn'>" +
        projNameAndUrl.name +
        "</td><td class='InfoColumn'>" +
        projNameAndUrl.url +
        "</td></tr>";
    });
    tableInformation = tableInformation + "</tr>";
    document.getElementById("projectsResponse").innerHTML = tableInformation;
  } else {
    document.getElementById("projectsResponse").innerHTML =
      "Unable to load projects";
  }
}

function getData() {
  let url = getUrlForVulnerabilityLevel();
  doGetAjaxCall(
    setDataInProjectsResponseDiv,
    url +
      "?fileurl=https://gist.githubusercontent.com/raw/bbf2e2183b8f6252061663ce0ddee79b",
    true
  );
}
